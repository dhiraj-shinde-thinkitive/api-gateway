spring:
  application:
    name: api-gateway
  
  
  # Redis Configuration
  data:
    redis:
      host: localhost
      port: 6379
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
  
  # RabbitMQ Configuration
#  rabbitmq:
#    host: localhost
#    port: 5672
#    username: guest
#    password: guest
    
  # Gateway Configuration
  cloud:
    gateway:
      routes:
        # Route all /api/** requests to AKMS service with API key authentication
        - id: akms-api
          uri: http://localhost:8084
          predicates:
            - Path=/api/**
          metadata:
            auth-type: api-key  # Custom metadata for authentication type

      # Global CORS configuration
      globalcors:
        cors-configurations:
          '[/**]':
            allowedorigins: "*"
            allowedmethods: "*"
            allowedheaders: "*"

# Server Configuration
server:
  port: 8081

# Eureka Configuration
eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
    service-url:
      defaultZone: http://localhost:8761/eureka

# Management endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always

# Logging Configuration
logging:
  level:
    com.sproutsai.api_gateway: DEBUG
    org.springframework.cloud.gateway: DEBUG
    
# Custom Application Properties
app:
  # API Key Management Service (AKMS) Configuration
  akms:
    base-url: http://localhost:8084
    timeout: 5000
  
  # Cache Configuration
  cache:
    api-key-ttl: 300 # 5 minutes
#
#  # Rate Limiting Configuration
#  rate-limit:
#    default-requests-per-minute: 4
  
  # Message Queue Configuration
  messaging:
    usage-log-queue: usage.logs
    usage-log-exchange: gateway.exchange